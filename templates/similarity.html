<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title> Каппа Веди Айтиндер </title>
  <link rel="stylesheet" href="/static/App.css">
  <link rel="stylesheet" href="/static/index.css">
</head>


{% macro dropdown(name, values, default_value) %}
    <select name="{{name}}"  form="persons">
    {% for person in values %}
        <option value="{{person.username}}" {% if person.username==default_value %} selected="selected" {% endif %}>
            {{person.first_name}} {{person.last_name}}
        </option>"
    {% endfor %}
    </select>
{% endmacro %}

{% macro person_href(person) %}
    <a href="/person/{{person.username}}">
        {{person.first_name}} {{person.last_name}}
    </a>
{% endmacro %}


<body>
  <div class="similarity-root">

<form method="POST" id="persons" action="/similarity">
    {{ dropdown('first', persons, first_default) }}
    {{ dropdown('second', persons, second_default) }}
    <input type="submit" value="Вычислить сходство">
</form>



{% if results is not none %}
    <table style="max-width:500px;margin:10px;">
        <tr>
            <td><img class="photo photo--small" src="{{ first_person.photo }}" /></td>
            <td><img class="photo photo--small" src="{{ second_person.photo }}" /></td>
        </tr>
    </table>
{% endif %}

{% if results %}
    {% for result in results %}
        <div> Сходство: {{ result.score }}.
            <ul class="similarity-list">
                <li> {{first_person.first_name}} - {{ result.first }} </li>
                <li> {{second_person.first_name}} - {{ result.second }} </li>
            </ul>
        </div>
    {% endfor %}
{% elif results is not none %}
    <div> Увы, пока сходства найти не получилось. Но это ещё наши алгоритмы тупенькие. Попробуйте другие пары! </div>
{% else %}
    <div> Выберите людей, сходство которых хотите найти, и нажмите "Отправить". </div>
{% endif %}

{% if results is not none %}
    <div>Смотреть пиплбук: {{ person_href(first_person) }} и {{ person_href(second_person) }} </div>
    <div> <a href="/similarity"> Другая пара </div>
    <div> <a href="/similarity/{{first_person.username}}/{{second_person.username}}">
        Ссылка на этот результат
    </a> </div>
{% endif %}

</div>
</body>
</html>